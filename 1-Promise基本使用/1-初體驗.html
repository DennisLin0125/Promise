<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>基本使用</title>
    <link crossorigin='anonymous' href="https://cdn.bootcss.com/twitter-bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container">
        <h2 class="page-header">Promise 初体验</h2>
        <button class="btn btn-primary" id="btn">点击抽奖</button>
    </div>
    <script>
        // 產生隨機數
        function rand(m,n){
            return Math.ceil(Math.random() * (n-m+1)) + m-1;
        }
        /**
             點選按鈕, 1s 後顯示是否中獎(30%機率中獎)
             若中獎彈出 恭喜恭喜, 獎品為 10萬 RMB 勞斯萊斯優惠券
             若未中獎彈出 再接再厲
        */
        //取得元素對象
        const btn = document.querySelector('#btn');
        //綁定點擊事件
        btn.addEventListener('click', function(){
            //定時器
             // setTimeout(() => {
             // //30% 1-100 1 2 30
             // //取得一個從1 - 100的隨機數
             // let n = rand(1, 100);
             // //判斷
             // if(n <= 30){
             // alert('恭喜恭喜, 獎品為 10萬 RMB 勞斯萊斯優惠券');
             // }else{
             // alert('再接再厲');
            
             // }, 1000);

             //Promise 形式實現
             // resolve 解決 函數類型的數據
             // reject 拒絕 函數類型的數據
             const p = new Promise((resolve, reject) => {
                 setTimeout(() => {
                     //30% 1-100 1 2 30
                     //取得從1 - 100的一個隨機數
                     let n = rand(1, 100);
                     //判斷
                     if(n <= 30){
                         resolve(n); // 將 promise 物件的狀態設為 ‘成功’
                     }else{
                         reject(n); // 將 promise 物件的狀態設為 ‘失敗’
                     }
                 }, 1000);
             });

             console.log(p);
             //呼叫 then 方法
             // value 值
             // reason 理由
             p.then((value) => {
                 alert('恭喜恭喜, 獎品為 10萬 RMB 勞斯萊斯優惠券, 您的中獎數字為 ' + value);
             }, (reason) => {
                 alert('再接再厲, 您的號碼為 ' + reason);
             });

        });

    </script>
</body>

</html>